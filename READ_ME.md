Climate effects on prey vulnerability modify expectations of predator
responses to climate fluctuations
================
Aïssa Morin 1, Simon Chamaillé-Jammes 2,4,5 and Marion Valeix 1,4,5
January 2020

<!-- <style type="text/css"> -->

<!-- <pdf_document: default
  html_document:
      keep_md: true > --> <!-- h1.title { -->
<!--   font-size: 28px; --> <!--   text-align: center; --> <!-- } -->

<!-- h4.author { -->

<!--   font-size: 20px; -->

<!--   text-align: center; -->

<!-- } -->

<!-- h4.date { -->

<!--   font-size: 18px; -->

<!--   text-align: center; -->

<!-- } -->

<!-- </style> -->

1 Laboratoire de Biométrie et Biologie Evolutive, UMR 5558, Centre
National de la Recherche Scientifique (CNRS), Université Lyon 1,
Université de Lyon, Bâtiment Gregor Mendel, 43 Boulevard du 11 Novembre
1918, F-69622 Villeurbanne Cedex, France

2 Centre d’Ecologie Fonctionnelle et Evolutive, UMR 5175, Centre
National de la Recherche Scientifique (CNRS), Université Montpellier,
Université Paul Valéry Montpellier 3, Ecole Pratique et des Hautes
Etudes, Institut de Recherche et Développement, 1919 route de Mende,
Montpellier, France

3 Mammal Research Institute, Department of Zoology and Entomology,
Faculty of Natural and Agricultural Sciences, University of Pretoria,
Hatfield, Pretoria, South Africa

4 Long-Term Socio-Ecological Research site (LTSER) France, Zone Atelier
“Hwange”, Hwange National Park, Bag 62, Dete, Zimbabwe - CNRS HERD
(Hwange Environmental Research Development) program

5 Wildlife Conservation Research Unit, Department of Zoology,
Recanati-Kaplan Centre, Oxford University, Tubney House, Abingdon Road,
Oxford OX13 5QL, United Kingdom

### I Introduction

This repository contains the code for simulations and figures associated
with the paper: “Climate effects on prey vulnerability modify
expectations of predator responses to climate fluctuations” by Morin,
Chamaillé-Jammes & Valeix.

In this study, we integrate prey vulnerability in a predator-prey
population dynamics model by modelling the population dynamics of a
predator preying on a density-dependent age-structured prey population,
while accounting for prey body condition and environmental effects on
prey vulnerability to predation, over the long- and the short-term.

The code for the simulations and figures consists in 5 R scripts:

  - The model (a R function): 01\_predator-prey\_model\_2019.R
  - Simulation code for the long-term response of predator populations
    to changes in mean annual rainfall (a R function):
    02\_Simulation\_LongTerm\_DefaultPar\_1000\_2019.R
  - Simulation code for the immediate response of predator populations
    to specific rainfall conditions (a R function):
    03\_Simulation\_ShortTerm\_DefaultPar\_1000\_2019.R
  - Script to run the aforementioned functions: Run\_simulations.R
  - Script to present the results in a figure: 04\_Generate-figures.R

These scripts are detailed below.

### II The model

The script “01\_predator-prey\_model\_2019.R” runs the code for the
predator-prey model and is structured as follows:

  - Default parameters values to see how the model works for scenario 4
    (climate affects prey vulnerability through both its influence on
    prey body condition and habitat characteristics) and when habitat
    driven hunting success increases with rainfall (HuntingSuccess ==
    positive).
  - Initialization
      - Scaling function allowing to account for density- and resource
        dependence in survival (“dd”)
      - Function to be run when predator handling time varies with
        rainfall
      - Tables to store model outcomes
  - The model
      - Calculation of juvenile and adult prey survival
      - Integration of predation in the prey model
      - Prey mortality
      - Update of both predator and prey populations
      - Model
outcomes

### III Long-term response of predator populations to changes in mean annual rainfall

The script “02\_Simulation\_LongTerm\_DefaultPar\_1000\_2019.R” runs the
simulation code for the long-term response of predator populations to
changes in mean annual rainfall. The code is structured as follows:

  - Default parameter values to see how the function works
  - Loading of the model (calls source
    “01\_predator-prey\_model\_2019.R”)
  - Prey, predators and handling time function parameters
  - Table for storing simulation outcomes
  - Generation of rainfall data for all simulations. Rainfall data for
    the z simulations are generated prior to run the simulations,
    allowing the different scenarios to be run with the same values of
    rainfall. The code starts by creating a list that contains 7
    matrices, one matrix for each mean/standard deviation (sd) couples,
    and each matrix is structured as follows: t rows (number of years in
    a simulation, default value is 201) and z columns (default value is
    1000). As the simulations run, the matrix corresponding to the
    mean/sd couple being tested and the column corresponding to the zth
    simulations are called. See below for an example of a matrix when
    mean = 600mm and SD =
90:

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">

<thead>

<tr>

<th style="text-align:left;">

</th>

<th style="text-align:right;">

Simulation 1

</th>

<th style="text-align:right;">

…

</th>

<th style="text-align:right;">

Simulation z

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left;">

t = 1

</td>

<td style="text-align:right;">

762.3388

</td>

<td style="text-align:right;">

609.5137

</td>

<td style="text-align:right;">

449.0401

</td>

</tr>

<tr>

<td style="text-align:left;">

…

</td>

<td style="text-align:right;">

708.6369

</td>

<td style="text-align:right;">

772.0765

</td>

<td style="text-align:right;">

493.2519

</td>

</tr>

<tr>

<td style="text-align:left;">

t = 200

</td>

<td style="text-align:right;">

554.5134

</td>

<td style="text-align:right;">

595.0627

</td>

<td style="text-align:right;">

578.3400

</td>

</tr>

</tbody>

</table>

  - Storing of model outcomes (5 lists, corresponding to the four
    scenarios being tested + the model without predation)
  - Simulation and model run:
      - Model run for each scenario
      - Outcomes of the model are organised in tables
  - Calculation of summary data:
      - mean predator population size
      - mean prey population size
      - mean proportion of vulnerable adult prey
  - File exportation (in the “output” folder): raw files and files
    containing summary data per simulation
      - Raw file name (default):
        “Raw\_Sim\_LongTerm\_meanpar\_HuntingSuccesspositive\_z1000\_t201.txt”
        or
        “Raw\_Sim\_LongTerm\_meanpar\_HuntingSuccessnegative\_z1000\_t201.txt”
      - Summary data file name (default):
        “Sim\_longterm\_meanpar\_HuntingSuccesspositive\_z1000\_t201.csv”
        or
        “Sim\_LongTerm\_meanpar\_HuntingSuccessnegative\_z1000\_t201.csv”

### IV Immediate response of predator populations to specific rainfall conditions

The script “03\_Simulation\_ShortTerm\_DefaultPar\_1000\_2019.R” runs
the simulation code for the immediate response of predator populations
to specific rainfall conditions. The code is structured as follows:

  - Default parameter values to see how the function works
  - Loading of the model (calls source
    “01\_predator-prey\_model\_2019.R.”)
  - Function for calculating the predator population growth rate over
    two time steps
  - Prey, predators and handling time function parameters
  - Table for storing simulation outcomes
  - Generating rainfall data for all simulations. Rainfall data for the
    z simulations are generated prior to run the simulations, allowing
    the different scenarios to be run with the same values of rainfall.
    The code starts by creating a list that contains 7 matrices, one
    matrix for each couple of average rainfall in the system (called
    Sys, Sys=600mm) and specific value (called Resfor, can take seven
    values from 100mm to 900mm by 100 increments), and each matrix is
    structured as followed: t rows (number of years in a simulation,
    default value is 200) and z columns (default values is 1000). As the
    simulations run, the zth column (corresponding to the zth
    simulation) of the matrix corresponding to the average
    rainfall/specific value couple being tested is called. For each
    simulation, 198 rainfall values are generated, drawn from a normal
    distribution with mean equal 600 (mean rainfall in the system): they
    correspond to rainfall values for the 198th first years of the
    simulation. Then, for the 199th year, a Resfor value, corresponding
    to the specific value of rainfall being tested, is imposed. Finally,
    the last rainfall value (when t=200) is drawn from a normal
    distribution with mean equal 600. See below for an example of a
    matrix when average rainfall in the system = 600mm and the specific
    value = 100
:

<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">

<thead>

<tr>

<th style="text-align:left;">

</th>

<th style="text-align:right;">

Simulation 1

</th>

<th style="text-align:right;">

…

</th>

<th style="text-align:right;">

Simulation z

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left;">

t = 1

</td>

<td style="text-align:right;">

519.7564

</td>

<td style="text-align:right;">

574.5583

</td>

<td style="text-align:right;">

750.3033

</td>

</tr>

<tr>

<td style="text-align:left;">

…

</td>

<td style="text-align:right;">

662.8941

</td>

<td style="text-align:right;">

604.7091

</td>

<td style="text-align:right;">

538.4193

</td>

</tr>

<tr>

<td style="text-align:left;">

t = 198

</td>

<td style="text-align:right;">

641.6359

</td>

<td style="text-align:right;">

551.8169

</td>

<td style="text-align:right;">

539.6729

</td>

</tr>

<tr>

<td style="text-align:left;">

t = 199

</td>

<td style="text-align:right;">

100.0000

</td>

<td style="text-align:right;">

100.0000

</td>

<td style="text-align:right;">

100.0000

</td>

</tr>

<tr>

<td style="text-align:left;">

t = 200

</td>

<td style="text-align:right;">

689.5036

</td>

<td style="text-align:right;">

597.9663

</td>

<td style="text-align:right;">

655.8521

</td>

</tr>

</tbody>

</table>

  - Storing of model outcomes (4 lists, corresponding to the four
    scenarios being tested)
  - Simulation and model run:
      - Model run for each scenario  
      - Outcomes of the model are organised in tables
  - Calculation of summary data:
      - Predator growth rate calculated over the last two years for each
        simulations
      - Proportion of adult prey calculated over the last two years for
        each simulations
  - File exportation (in the “output” folder): raw files and files
    containing summary data per simulation only
      - Raw file name :
        “Raw\_Sim\_ShortTerm\_meanpar\_HuntingSuccesspositive\_z1000\_t201.txt”
        or “Raw\_Sim\_ ShortTerm
        \_meanpar\_HuntingSuccessnegative\_z1000\_t201.txt”
      - Summary data file name:
        “Sim\_ShortTerm\_meanpar\_HuntingSuccesspositive\_z1000\_t201.csv”
        or
        “Sim\_ShortTerm\_meanpar\_HuntingSuccessnegative\_z1000\_t201.csv”

### V Run simulations

The code “Run\_simulations.R” allows to run the simulations for both the
long-term response of predator populations to changes in mean annual
rainfall and the immediate response of predator populations to specific
rainfall conditions. For the two functions, the code is structured as
follows:

  - Long term response: The user must define the directory in which the
    code for the simulation is. Calls source
    “Simulation\_LongTerm\_MeanPar\_1000\_2019.R”. Run the function.

  - Immediate response: The user must define the directory in which the
    code for the simulation is. Calls source
    “Simulation\_ShortTerm\_MeanPar\_1000\_2019.R”. Run the function.

For each function the user must define the following parameters:

  - t: number of years in each simulation,
  - z: the number of simulations,
  - HuntingSuccess : the type of functional relationship between habitat
    driven hunting success and rainfall ( either “positive” or
    “negative”)
  - dir1: the directory where the script of the model
    (01\_predator-prey\_model\_2019.R) can be found. By default the
    project folder : “.”
  - dir2: the directory where the output files should be stored. By
    default the output folder : “./output/”
  - dorawdata: whether the file with the raw data must be generated and
    exported (TRUE) or not (FALSE, default value)

### VI Visualization of results

The script “04\_Generate-figures.R” allows to reproduce the main figure
of the article (Figure 3). The script is structured as follows:

First, the code creates the two subfigures for the long-term response of
predator populations to changes in mean annual rainfall, i.e. the
predator mean population size as a function of rainfall:

  - Fig 2C: when the habitat driven hunting success increases with
    rainfall (h -handling time- varies negatively with rainfall)
  - Fig 2D: when the habitat driven hunting success decreases with
    rainfall (h -handling time- varies positively with rainfall)

Second, the code creates the two subfigures for the immediate response
of predator populations to specific rainfall condition, i.e. the
predator population growth rate as a function of predetermined value of
rainfall (Resfor)

  - Fig 2A: when the habitat driven hunting success increases with
    rainfall (h -handling time- varies negatively with rainfall)
  - Fig 2B: when the habitat driven hunting success decreases with
    rainfall (h -handling time- varies positively with rainfall)

Finally, the code put together the subfigures into one final figure
which can be saved.

The user will have to define

  - Directory where the files with simulation outputs can be found
  - For each subfigure, the output file name (generated by the
    simulations)

Default file name (for z = 1000 simulations of t = 200 years):

  - Fig 2C:
    “Sim\_LongTerm\_meanpar\_HuntingSuccesspositive\_z1000\_t201.csv”
  - Fig 2D:
    “Sim\_LongTerm\_meanpar\_HuntingSuccessnegative\_z1000\_t201.csv”
  - Fig 2A:
    “Sim\_ShortTerm\_meanpar\_HuntingSuccesspositive\_z1000\_t201.csv”
  - Fig 2B: “Sim\_ ShortTerm
    \_meanpar\_HuntingSuccessnegative\_z1000\_t201.csv”

The figures are saved in the default “figs” folder.

### VII Code licensing

This code was developed in R Version 3.6.1. This code is licensed under
the terms of the GNU General Public License v3.0.
